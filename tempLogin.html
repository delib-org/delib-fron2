<!DOCTYPE html>
<html>

  <head>
    <title>דליב: מחליטים ביחד</title>
    <meta charset="utf-8">
    <!-- Material Ripple CSS -->
    <link rel="stylesheet" href="css/ripple.min.css">

    <script type="text/javascript" src="js/jquery-2.2.3.min.js"></script>
    <script type="text/javascript" src="js/handlebars-v4.0.5.js"></script>
    <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>
    <!-- Material Ripple JS -->
    <script src="js/jquery-epulse.min.js"></script>


    <link rel="stylesheet" href="css/font-awesome-4.6.1/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <link href='https://fonts.googleapis.com/css?family=Alef:400,700' rel='stylesheet' type='text/css'>

  </head>

  <body>
    <script>
      //Facebook SDK
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '1792567630962896',
          xfbml      : true,
          version    : 'v2.6'
        });
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         js.src = "//connect.facebook.net/en_US/sdk.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
    </script>
    <div
      class="fb-like"
      data-share="true"
      data-width="450"
      data-show-faces="true">
    </div>
    <div>
    <form id="signup-form" method="post" dir=ltr>
      <input type="email" name="email" placeholder="email">
      <input type="password" name="pass" placeholder="password">
      <button type="submit">signup</button>
    </form>
    </div><br>
    <div>
    <form id="login-form" method="post" dir=ltr>
      <input type="email" name="email" placeholder="email">
      <input type="password" name="pass" placeholder="password">
      <button type="submit">login</button>
    </form>
    </div><br>
    <button type="button" onclick="signout()">Sign out</button>
    <button type="button" onclick="facebookLogin()">Facebook</button>
    <button type="button" onclick="googleLogin()">Google</button>
    <script>

      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyBEumZUTCL3Jc9pt7_CjiSVTxmz9aMqSvo",
        authDomain: "synthesistalyaron.firebaseapp.com",
        databaseURL: "https://synthesistalyaron.firebaseio.com",
        storageBucket: "gs://synthesistalyaron.appspot.com",
      };
      firebase.initializeApp(config);

      var DB = firebase.database().ref();
      var storage = firebase.storage();


      //Facebook login
      var provider = new firebase.auth.FacebookAuthProvider();

      function facebookLogin(){
        firebase.auth().signInWithRedirect(provider);

      }

      firebase.auth().getRedirectResult().then(function(result) {
          if (result.credential) {
            // This gives you a Facebook Access Token. You can use it to access the Facebook API.
            var token = result.credential.accessToken;
            console.log("token: "+ token);
            // ...
          }
          // The signed-in user info.
          var user = result.user;
          console.log("FB user: "+ JSON.stringify(user));
        }).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // The email of the user's account used.
          var email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          var credential = error.credential;

          console.log("FB error: " + email+ ", "+errorMessage + ", "+errorCode + ", "+ credential)
          // ...
        });


      $("#signup-form").submit(function(e){

        e.preventDefault();

        console.log(this.email.value+ ", "+ this.pass.value);

        firebase.auth().createUserWithEmailAndPassword(this.email.value, this.pass.value).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          console.log("Error: "+ errorMessage+" : "+ errorCode);
          });
      });

      $("#login-form").submit(function(e){

        e.preventDefault();
        firebase.auth().signInWithEmailAndPassword(this.email.value, this.pass.value).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          console.log("Error: "+ errorMessage+" : "+ errorCode);
        });

      });


      function signout(){
        firebase.auth().signOut().then(function() {
          console.log("sign out");
        }, function(error) {
          console.log("Error: "+ error)
        });
      }

      firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
          console.log("User: "+ user.email +", "+ user.uid);
        } else {
          console.log("No user is signed in.");
        }
      });



    </script>
  </body>
</html>
